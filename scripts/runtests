#!/usr/bin/env bash

set -e

export PATH=node_modules/.bin:${PATH}
export PATH=env/bin:${PATH}
export DEBUG=true
export IN_TEST=true
export SECRET_KEY='secrit'

flake8 project --ignore=E128,E501 --exclude=migrations,settings,wsgi.py
coverage run --source=project --omit='*/wsgi.py,*/settings.py,*/migrations/*.py,*__init__.py' manage.py test $@
coverage report

eslint static/src
sass-lint -vqc .sass-lint.yml

bandit -r project/ manage.py
safety check
nsp check
snyk test
