#!/usr/bin/env bash

if [ -z "$NVM_DIR" ]
then
    NVM_DIR="$HOME/.nvm"
fi

. $NVM_DIR/nvm.sh
nvm install
nvm use

set -e

pyvenv env
env/bin/pip install -r requirements.txt

echo ">> Cleaning plugins..."
rm -rf pelican_plugins

echo ">> Installing Plugins"
git clone --recursive https://github.com/getpelican/pelican-plugins --depth=1 pelican_plugins/

echo ">> Hot fixing..."
rm -rf pelican_plugins/pelican-jinja2content
git clone https://github.com/RealOrangeOne/pelican-jinja2content -b patch-1 --depth=1 pelican_plugins/pelican-jinja2content

npm install
